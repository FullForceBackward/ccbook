<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width,minimum-scale=1">

  <title>The Case of Million Song</title>
  <meta name="description" content="            &#20351;&#29992;Turicreate&#36827;&#34892;&#38899;&#20048;&#25512;&#33616;     !pip install turicreate    Collecting turicreate  Downloading turi...">

  <link rel="canonical" href="https://computational-class.github.io/ccbook/14-millionsong.html">
  <link rel="alternate" type="application/rss+xml" title="Elements of Computational Communication" href="https://computational-class.github.io/ccbook/feed.xml">

  <meta property="og:url"         content="https://computational-class.github.io/ccbook/14-millionsong.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="The Case of Million Song" />
<meta property="og:description" content="            &#20351;&#29992;Turicreate&#36827;&#34892;&#38899;&#20048;&#25512;&#33616;     !pip install turicreate    Collecting turicreate  Downloading turi..." />
<meta property="og:image"       content="https://computational-class.github.io/ccbook/img/logo/logo.png" />

<meta name="twitter:card" content="summary">


  <script type="application/ld+json">
  {
  "@context": "http://schema.org",
  "@type": "NewsArticle",
  "mainEntityOfPage": "https://computational-class.github.io/ccbook/14-millionsong.html",
  "headline": "The Case of Million Song",
  "datePublished": "2020-06-14T20:21:17+08:00",
  "dateModified": "2020-06-14T20:21:17+08:00",
  "description": "            &#20351;&#29992;Turicreate&#36827;&#34892;&#38899;&#20048;&#25512;&#33616;     !pip install turicreate    Collecting turicreate  Downloading turi...",
  "author": {
    "@type": "Person",
    "name": "王成军"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Data 100 at UC Berkeley",
    "logo": {
      "@type": "ImageObject",
      "url": "https://computational-class.github.io/ccbook",
      "width": 60,
      "height": 60
    }
  },
  "image": {
    "@type": "ImageObject",
    "url": "https://computational-class.github.io/ccbook",
    "height": 60,
    "width": 60
  }
}

  </script>
  <link rel="stylesheet" href="/ccbook/assets/css/styles.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.2/css/regular.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.2/css/solid.css">

  <!-- <link rel="manifest" href="/manifest.json"> -->
  <!-- <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#efae0a"> -->
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="msapplication-TileImage" content="/mstile-144x144.png">
  <meta name="theme-color" content="#233947">

  <!-- Favicon -->
  <link rel="shortcut icon" type="image/x-icon" href="/ccbook/images/logo/favicon.ico">

  <!-- MathJax Config -->
  <!-- Allow inline math using $ and automatically break long math lines -->
<!-- (mostly) copied from nbconvert configuration -->
<!-- https://github.com/jupyter/nbconvert/blob/master/nbconvert/templates/html/mathjax.tpl -->
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true,
        processEnvironments: true
    },
    // Center justify equations in code and markdown cells. Elsewhere
    // we use CSS to left justify single line equations in code cells.
    displayAlign: 'center',
    "HTML-CSS": {
        styles: {'.MathJax_Display': {"margin": 0}},
        linebreaks: { automatic: true },
    }
});
</script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS_HTML' async></script>


  <!-- DOM updating function -->
  <script src="/ccbook/assets/js/dom-update.js"></script>

  <!-- Selectors for elements on the page -->
  <script src="/ccbook/assets/js/documentSelectors.js"></script>

  <!-- Define some javascript variables that will be useful in other javascript -->
  <script>
    const site_basename = '/ccbook';
  </script>

  <!-- Add AnchorJS to let headers be linked -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.2.0/anchor.min.js" async></script>
  <script src="/ccbook/assets/js/anchors.js" async></script>

  <!-- Include Turbolinks to make page loads fast -->
  <!-- https://github.com/turbolinks/turbolinks -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/turbolinks/5.2.0/turbolinks.js" async></script>
  <meta name="turbolinks-cache-control" content="no-cache">

  <!-- Load nbinteract for widgets -->
  

  <!-- Load Thebelab for interactive widgets -->
  <!-- Include Thebelab for interactive code if it's enabled -->



  <!-- Load the auto-generating TOC (non-async otherwise the TOC won't load w/ turbolinks) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.min.js" async></script>
  <script src="/ccbook/assets/js/tocbot.js"></script>

  <!-- Google analytics -->
  
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id="></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', '');
</script>



  <!-- Clipboard copy button -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" async></script>

  <!-- Load custom website scripts -->
  <script src="/ccbook/assets/js/scripts.js" async></script>

  <!-- Load custom user CSS and JS  -->
  <script src="/ccbook/assets/custom/custom.js" async></script>
  <link rel="stylesheet" href="/ccbook/assets/custom/custom.css">

  <!-- Update interact links w/ REST param, is defined in includes so we can use templates -->
  
<script>
/**
  * To auto-embed hub URLs in interact links if given in a RESTful fashion
 */

function getJsonFromUrl(url) {
  var query = url.split('?');
  if (query.length < 2) {
    // No queries so just return false
    return false;
  }
  query = query[1];
  // Collect REST params into a dictionary
  var result = {};
  query.split("&").forEach(function(part) {
    var item = part.split("=");
    result[item[0]] = decodeURIComponent(item[1]);
  });
  return result;
}
    
function dict2param(dict) {
    params = Object.keys(dict).map(function(k) {
        return encodeURIComponent(k) + '=' + encodeURIComponent(dict[k])
    });
    return params.join('&')
}

// Parse a Binder URL, converting it to the string needed for JupyterHub
function binder2Jupyterhub(url) {
  newUrl = {};
  parts = url.split('v2/gh/')[1];
  // Grab the base repo information
  repoinfo = parts.split('?')[0];
  var [org, repo, ref] = repoinfo.split('/');
  newUrl['repo'] = ['https://github.com', org, repo].join('/');
  newUrl['branch'] = ref
  // Grab extra parameters passed
  params = getJsonFromUrl(url);
  if (params['filepath'] !== undefined) {
    newUrl['subPath'] = params['filepath']
  }
  return dict2param(newUrl);
}

// Filter out potentially unsafe characters to prevent xss
function safeUrl(url)
{
   return String(encodeURIComponent(url))
            .replace(/&/g, '&amp;')
            .replace(/"/g, '&quot;')
            .replace(/'/g, '&#39;')
            .replace(/</g, '&lt;')
            .replace(/>/g, '&gt;');
}

function addParamToInternalLinks(hub) {
  var links = document.querySelectorAll("a").forEach(function(link) {
    var href = link.href;
    // If the link is an internal link...
    if (href.search("https://computational-class.github.io") !== -1 || href.startsWith('/') || href.search("127.0.0.1:") !== -1) {
      // Assume we're an internal link, add the hub param to it
      var params = getJsonFromUrl(href);
      if (params !== false) {
        // We have REST params, so append a new one
        params['jupyterhub'] = hub;
      } else {
        // Create the REST params
        params = {'jupyterhub': hub};
      }
      // Update the link
      var newHref = href.split('?')[0] + '?' + dict2param(params);
      link.setAttribute('href', decodeURIComponent(newHref));
    }
  });
  return false;
}


// Update interact links
function updateInteractLink() {
    // hack to make this work since it expects a ? in the URL
    rest = getJsonFromUrl("?" + location.search.substr(1));
    jupyterHubUrl = rest['jupyterhub'];
    var hubType = null;
    var hubUrl = null;
    if (jupyterHubUrl !== undefined) {
      hubType = 'jupyterhub';
      hubUrl = jupyterHubUrl;
    }

    if (hubType !== null) {
      // Sanitize the hubUrl
      hubUrl = safeUrl(hubUrl);

      // Add HTTP text if omitted
      if (hubUrl.indexOf('http') < 0) {hubUrl = 'http://' + hubUrl;}
      var interactButtons = document.querySelectorAll("button.interact-button")
      var lastButton = interactButtons[interactButtons.length-1];
      var link = lastButton.parentElement;

      // If we've already run this, skip the link updating
      if (link.nextElementSibling !== null) {
        return;
      }

      // Update the link and add context div
      var href = link.getAttribute('href');
      if (lastButton.id === 'interact-button-binder') {
        // If binder links exist, we need to re-work them for jupyterhub
        if (hubUrl.indexOf('http%3A%2F%2Flocalhost') > -1) {
          // If localhost, assume we're working from a local Jupyter server and remove `/hub`
          first = [hubUrl, 'git-sync'].join('/')
        } else {
          first = [hubUrl, 'hub', 'user-redirect', 'git-sync'].join('/')
        }
        href = first + '?' + binder2Jupyterhub(href);
      } else {
        // If interact button isn't binderhub, assume it's jupyterhub
        // If JupyterHub links, we only need to replace the hub url
        href = href.replace("", hubUrl);
        if (hubUrl.indexOf('http%3A%2F%2Flocalhost') > -1) {
          // Assume we're working from a local Jupyter server and remove `/hub`
          href = href.replace("/hub/user-redirect", "");
        }
      }
      link.setAttribute('href', decodeURIComponent(href));

      // Add text after interact link saying where we're launching
      hubUrlNoHttp = decodeURIComponent(hubUrl).replace('http://', '').replace('https://', '');
      link.insertAdjacentHTML('afterend', '<div class="interact-context">on ' + hubUrlNoHttp + '</div>');

      // Update internal links so we retain the hub url
      addParamToInternalLinks(hubUrl);
    }
}

runWhenDOMLoaded(updateInteractLink)
document.addEventListener('turbolinks:load', updateInteractLink)
</script>


  <!-- Lunr search code - will only be executed on the /search page -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lunr.js/2.3.6/lunr.min.js" async></script>
  <script>var initQuery = function() {
  // See if we have a search box
  var searchInput = document.querySelector('input#lunr_search');
  if (searchInput === null) {
    return;
  }

  // Function to parse our lunr cache
  var idx = lunr(function () {
    this.field('title')
    this.field('excerpt')
    this.field('categories')
    this.field('tags')
    this.ref('id')

    this.pipeline.remove(lunr.trimmer)

    for (var item in store) {
      this.add({
        title: store[item].title,
        excerpt: store[item].excerpt,
        categories: store[item].categories,
        tags: store[item].tags,
        id: item
      })
    }
  });

  // Run search upon keyup
  searchInput.addEventListener('keyup', function () {
    var resultdiv = document.querySelector('#results');
    var query = document.querySelector("input#lunr_search").value.toLowerCase();
    var result =
      idx.query(function (q) {
        query.split(lunr.tokenizer.separator).forEach(function (term) {
          q.term(term, { boost: 100 })
          if(query.lastIndexOf(" ") != query.length-1){
            q.term(term, {  usePipeline: false, wildcard: lunr.Query.wildcard.TRAILING, boost: 10 })
          }
          if (term != ""){
            q.term(term, {  usePipeline: false, editDistance: 1, boost: 1 })
          }
        })
      });

      // Empty the results div
      while (resultdiv.firstChild) {
        resultdiv.removeChild(resultdiv.firstChild);
      }

    resultdiv.insertAdjacentHTML('afterbegin', '<p class="results__found">'+result.length+' Result(s) found</p>');
    for (var item in result) {
      var ref = result[item].ref;
      if(store[ref].teaser){
        var searchitem =
          '<div class="list__item">'+
            '<article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">'+
              '<h2 class="archive__item-title" itemprop="headline">'+
                '<a href="'+store[ref].url+'" rel="permalink">'+store[ref].title+'</a>'+
              '</h2>'+
              '<div class="archive__item-teaser">'+
                '<img src="'+store[ref].teaser+'" alt="">'+
              '</div>'+
              '<p class="archive__item-excerpt" itemprop="description">'+store[ref].excerpt.split(" ").splice(0,20).join(" ")+'...</p>'+
            '</article>'+
          '</div>';
      }
      else{
    	  var searchitem =
          '<div class="list__item">'+
            '<article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">'+
              '<h2 class="archive__item-title" itemprop="headline">'+
                '<a href="'+store[ref].url+'" rel="permalink">'+store[ref].title+'</a>'+
              '</h2>'+
              '<p class="archive__item-excerpt" itemprop="description">'+store[ref].excerpt.split(" ").splice(0,20).join(" ")+'...</p>'+
            '</article>'+
          '</div>';
      }
      resultdiv.insertAdjacentHTML('beforeend', searchitem);
    }
  });
};

initFunction(initQuery);
</script>

  <!-- Load JS that depends on site variables -->
  <script src="/ccbook/assets/js/copy-button.js" async></script>

  <!-- Hide cell code -->
  <script src="/ccbook/assets/js/hide-cell.js" async></script>

  <!-- Printing the screen -->
  <!-- Include nbinteract for interactive widgets -->
<script src="https://printjs-4de6.kxcdn.com/print.min.js" async></script>
<script>
printContent = () => {
    // MathJax displays a second version of any math for assistive devices etc.
    // This prevents double-rendering in the PDF output.
    var ignoreAssistList = [];
    assistives = document.querySelectorAll('.MathJax_Display span.MJX_Assistive_MathML').forEach((element, index) => {
        var thisId = 'MathJax-assistive-' + index.toString();
        element.setAttribute('id', thisId);
        ignoreAssistList.push(thisId)
    });

    // Print the actual content object
    printJS({
        printable: 'textbook_content',
        type: 'html',
        css: "/ccbook/assets/css/styles.css",
        scanStyles: false,
        targetStyles: ["*"],
        ignoreElements: ignoreAssistList
    })
};

initPrint = () => {
    document.querySelector('#interact-button-print').addEventListener('click', printContent)
}

initFunction(initPrint)
</script>

</head>

  <body>
    <!-- .js-show-sidebar shows sidebar by default -->
    <div id="js-textbook" class="c-textbook js-show-sidebar">
      



<nav id="js-sidebar" class="c-textbook__sidebar">
  <a href="https://computational-class.github.io/ccbook/"><img src="/ccbook/img/logo/logo.png" class="textbook_logo" id="sidebar-logo" data-turbolinks-permanent/></a>
  <h2 class="c-sidebar__title">Elements of Computational Communication</h2>
  <ul class="c-sidebar__chapters">
    
      
      
        <li class="c-sidebar__divider"></li>
        
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/ccbook/00-preface.html"
        >
          
          Preface
        </a>

        
      </li>

      
    
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/ccbook/00-acknowledgement.html"
        >
          
          Acknowledgement
        </a>

        
      </li>

      
    
      
      
        <li class="c-sidebar__divider"></li>
        
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/ccbook/01-intro2cjc.html"
        >
          
            1.
          
          Introduction to Computational Communication
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ccbook/02-bigdata.html"
                >
                  
                    1.1
                  
                  Understanding Big Data
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/ccbook/03-python-intro.html"
        >
          
            2.
          
          Introduction of Python Programming
        </a>

        
      </li>

      
    
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/ccbook/04-crawler-beautifulsoup.html"
        >
          
            3.
          
          Data Collection
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ccbook/04-crawler-wechat.html"
                >
                  
                    3.1
                  
                  Crawling WeChat Public Accounts
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ccbook/04-crawler-douban.html"
                >
                  
                    3.2
                  
                  Crawling Douban Movies
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ccbook/04-crawler-cppcc.html"
                >
                  
                    3.3
                  
                  Collecting CPPCC proposals
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ccbook/04-crawler-selenium.html"
                >
                  
                    3.4
                  
                  Introduction of Selenium
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ccbook/04-crawler-selenium-people-com-search.html"
                >
                  
                    3.5
                  
                  Using Selenium for searching
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ccbook/04-crawler-tripadvisor.html"
                >
                  
                    3.6
                  
                  Using selenium for clicking
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ccbook/04-crawler-netease-music.html"
                >
                  
                    3.7
                  
                  Crawling Music Data
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ccbook/04-crawler-gov-report.html"
                >
                  
                    3.8
                  
                  Crawling Government Reports
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/ccbook/06-data-cleaning-intro.html"
        >
          
            4.
          
          Data Cleaning
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ccbook/06-data-cleaning-preprocessing.html"
                >
                  
                    4.1
                  
                  Preprocessing Big Data
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ccbook/06-data-cleaning-pandas.html"
                >
                  
                    4.2
                  
                  Data Processing with Pandas
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ccbook/06-data-cleaning-tweets.html"
                >
                  
                    4.3
                  
                  Data Cleaning of OWS tweets
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ccbook/07-data-cleaning-occupy-central-news.html"
                >
                  
                    4.4
                  
                  Cleaning the News of Occupy Central
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ccbook/06-data-cleaning-music-list.html"
                >
                  
                    4.5
                  
                  Cleaning A Music List
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/ccbook/08-01-statistics-thinking.html"
        >
          
            5.
          
          Statistics Thinking
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ccbook/08-02-linear-algebra.html"
                >
                  
                    5.1
                  
                  Linear Algebra
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ccbook/08-03-probability.html"
                >
                  
                    5.2
                  
                  Probability
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ccbook/08-03-distributions.html"
                >
                  
                    5.3
                  
                  Distribution
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ccbook/08-04-hypothesis-inference.html"
                >
                  
                    5.4
                  
                  Hypothesis Inference
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ccbook/08-05-gradient-descent.html"
                >
                  
                    5.5
                  
                  Gradient Descent
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ccbook/08-06-regression.html"
                >
                  
                    5.6
                  
                  Linear Regression
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ccbook/08-06-statsmodels.html"
                >
                  
                    5.7
                  
                  Introduction to statsmodels
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ccbook/08-07-analyzing-titanic-dataset.html"
                >
                  
                    5.8
                  
                  Analyzing Titanic Dataset
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ccbook/08-07-covid19-pew-survey.html"
                >
                  
                    5.9
                  
                  Analysing the Pew Survey Data of COVID19
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ccbook/08-08-covid19-grangercausality.html"
                >
                  
                    5.10
                  
                  Granger Causality of COVID19
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/ccbook/09-01-machine-learning-with-sklearn.html"
        >
          
            6.
          
          Machine Learning
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ccbook/09-03-hyperparameters-and-model-validation.html"
                >
                  
                    6.1
                  
                  Hyperparameters and Model Validation
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ccbook/09-04-feature-engineering.html"
                >
                  
                    6.2
                  
                  Feature Engineering
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ccbook/09-05-naive-bayes.html"
                >
                  
                    6.3
                  
                  Naive Bayes
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ccbook/09-06-linear-regression.html"
                >
                  
                    6.4
                  
                  Linear Regression
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ccbook/09-07-support-vector-machines.html"
                >
                  
                    6.5
                  
                  Support Vector Machines
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ccbook/09-08-random-forests.html"
                >
                  
                    6.6
                  
                  Random Forests
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ccbook/09-09-machine-learning-summary.html"
                >
                  
                    6.7
                  
                  Summary
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ccbook/09-10-future-employment.html"
                >
                  
                    6.8
                  
                  Case study of future employment
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/ccbook/09-neural-network.html"
        >
          
            7.
          
          Neural Network
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ccbook/09-neural-network-advanced.html"
                >
                  
                    7.1
                  
                  Advanced Topics
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/ccbook/10-text-minning-gov-report.html"
        >
          
            8.
          
          Text Mining
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ccbook/10-word2vec.html"
                >
                  
                    8.1
                  
                  Word2vec
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ccbook/11-sentiment-analysis-with-dict.html"
                >
                  
                    8.2
                  
                  Sentiment Analysis with Dictionary
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ccbook/11-sentiment-classifier.html"
                >
                  
                    8.3
                  
                  Sentiment Analysis with Machine Learning
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ccbook/12-topic-models-update.html"
                >
                  
                    8.4
                  
                  Topic Models
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ccbook/12-topic-models-with-turicreate.html"
                >
                  
                    8.5
                  
                  Topic Models with Turicreate
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/ccbook/13-recsys-intro.html"
        >
          
            9.
          
          Recommendation System
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections ">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry c-sidebar__entry--active"
                  href="/ccbook/14-millionsong.html"
                >
                  
                    9.1
                  
                  The Case of Million Song
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ccbook/14-movielens.html"
                >
                  
                    9.2
                  
                  The Case of Movielens
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/ccbook/15-network-science-intro.html"
        >
          
            10.
          
          Network Science
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ccbook/16-network-science-models.html"
                >
                  
                    10.1
                  
                  Network Models
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ccbook/17-networkx.html"
                >
                  
                    10.2
                  
                  networkx
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ccbook/18-network-analysis-of-tianya-bbs.html"
                >
                  
                    10.3
                  
                  The case of Tianya BBS
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ccbook/18-network-epidemics.html"
                >
                  
                    10.4
                  
                  Network Epidemics
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/ccbook/19-visualization-with-seaborn.html"
        >
          
            11.
          
          Visualization
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ccbook/19-visualization-datashader.html"
                >
                  
                    11.1
                  
                  datashader
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ccbook/19-visualization-with-pyecharts.html"
                >
                  
                    11.2
                  
                  pyecharts
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ccbook/19-visualization-maps-using-folium.html"
                >
                  
                    11.3
                  
                  folium
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="/ccbook/0-common-questions.html"
        >
          
            12.
          
          Appendix
        </a>

        

          
          
          
          

          

          <ul class="c-sidebar__sections u-hidden-visually">
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ccbook/0-jupyter-notebook.html"
                >
                  
                    12.1
                  
                  Appendix of Using Jupyter Notebooks
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ccbook/0-slides.html"
                >
                  
                    12.2
                  
                  Appendix of Making Slides with RISE
                </a>

                
                

              </li>
              
            
              
              

              <li class="c-sidebar__section">
                <a class="c-sidebar__entry "
                  href="/ccbook/0-turicreate.html"
                >
                  
                    12.3
                  
                  Appendix of Using Turicreate
                </a>

                
                

              </li>
              
            
          </ul>
        
      </li>

      
    
      
      
        <li><h2 class="c-sidebar__title">Resources</li>
        
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="https://github.com/jupyter/jupyter-book"
        >
          
          Jupyter Book
        </a>

        
      </li>

      
    
      
      

      
      

      
      
      <li class="c-sidebar__chapter">
        <a class="c-sidebar__entry "
          href="https://github.com/computational-class/ccbook"
        >
          
          GitHub repository
        </a>

        
      </li>

      
    
  </ul>
  <p class="sidebar_footer">Powered by <a href="https://github.com/jupyter/jupyter-book">Jupyter Book</a></p>
</nav>

      
      <div class="c-topbar" id="top-navbar">
  <!-- We show the sidebar by default so we use .is-active -->
  <div class="c-topbar__buttons">
    <button
      id="js-sidebar-toggle"
      class="hamburger hamburger--arrowalt is-active"
    >
      <span class="hamburger-box">
        <span class="hamburger-inner"></span>
      </span>
    </button>
    <div class="buttons">

<div class="download-buttons-dropdown">
    <button id="dropdown-button-trigger" class="interact-button">
      <img src="/ccbook/assets/images/download-solid.svg" height="15" width="15" alt="Download" />
      <!-- PDF -->
    </button>
    <div class="download-buttons">
        
        <a id="interact-button-print"><button id="interact-button-download" class="interact-button">.pdf</button></a>
    </div>
</div>


  
  
  






<a href="https://mybinder.org/v2/gh/computational-class/ccbook/gh-pages?filepath=content%2F14-millionsong.ipynb"><button class="interact-button" id="interact-button-binder"><img class="interact-button-logo" src="/ccbook/assets/images/logo_binder.svg" alt="Interact" />Interact</button></a>
  


</div>

  </div>
  <!-- Empty sidebar placeholder that we'll auto-fill with javascript -->
  <aside class="sidebar__right">
    <header><h4 class="nav__title"><i class="fa fa-list"></i>   On this page</h4></header>
    <nav class="onthispage">
    </nav>
  </aside>
  <a href="/ccbook/search.html" class="topbar-right-button" id="search-button"><i class="fa fa-search"></i></a>
</div>

      <main class="c-textbook__page" tabindex="-1">
            <div class="c-textbook__content" id="textbook_content">
                  <main class="jupyter-page">
    <div id="page-info"></div>
    <div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>
<hr>
<h1 id="&#20351;&#29992;Turicreate&#36827;&#34892;&#38899;&#20048;&#25512;&#33616;">&#20351;&#29992;Turicreate&#36827;&#34892;&#38899;&#20048;&#25512;&#33616;<a class="anchor-link" href="#&#20351;&#29992;Turicreate&#36827;&#34892;&#38899;&#20048;&#25512;&#33616;"> </a></h1><hr>
<hr>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>pip install turicreate
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Collecting turicreate
  Downloading turicreate-6.3-cp37-cp37m-macosx_10_12_intel.macosx_10_12_x86_64.macosx_10_13_intel.macosx_10_13_x86_64.macosx_10_14_intel.macosx_10_14_x86_64.whl (33.1 MB)
     |████████████████████████████████| 33.1 MB 13 kB/s eta 0:00:0197   |████████▍                       | 8.6 MB 19 kB/s eta 0:20:35     |███████████████████▌            | 20.2 MB 24 kB/s eta 0:08:42     |███████████████████▊            | 20.4 MB 12 kB/s eta 0:16:49     |██████████████████████████████▉ | 31.8 MB 39 kB/s eta 0:00:32
Collecting coremltools==3.3
  Downloading coremltools-3.3-cp37-none-macosx_10_14_intel.whl (3.5 MB)
     |████████████████████████████████| 3.5 MB 18 kB/s eta 0:00:0115   |███████▋                        | 829 kB 12 kB/s eta 0:03:30
Requirement already satisfied: requests&gt;=2.9.1 in /opt/anaconda3/lib/python3.7/site-packages (from turicreate) (2.22.0)
Requirement already satisfied: pandas&gt;=0.23.2 in /opt/anaconda3/lib/python3.7/site-packages (from turicreate) (1.0.1)
Requirement already satisfied: numpy in /opt/anaconda3/lib/python3.7/site-packages (from turicreate) (1.18.1)
Requirement already satisfied: decorator&gt;=4.0.9 in /opt/anaconda3/lib/python3.7/site-packages (from turicreate) (4.4.1)
Requirement already satisfied: pillow&gt;=5.2.0 in /opt/anaconda3/lib/python3.7/site-packages (from turicreate) (7.0.0)
Requirement already satisfied: prettytable==0.7.2 in /opt/anaconda3/lib/python3.7/site-packages (from turicreate) (0.7.2)
Requirement already satisfied: six&gt;=1.10.0 in /opt/anaconda3/lib/python3.7/site-packages (from turicreate) (1.14.0)
Collecting resampy==0.2.1
  Using cached resampy-0.2.1.tar.gz (322 kB)
Collecting tensorflow&gt;=2.0.0
  Downloading tensorflow-2.2.0-cp37-cp37m-macosx_10_11_x86_64.whl (175.3 MB)
     |████████████████████████████████| 175.3 MB 8.8 kB/s ta 0:00:018   |██▏                             | 12.0 MB 62 kB/s eta 0:43:16     |████████▎                       | 45.2 MB 21 kB/s eta 1:39:12     |████████▎                       | 45.5 MB 17 kB/s eta 2:07:02     |█████████                       | 48.7 MB 36 kB/s eta 0:58:32     |█████████▍                      | 51.2 MB 40 kB/s eta 0:50:59     |██████████▍                     | 56.8 MB 14 kB/s eta 2:11:51     |██████████████▊                 | 81.0 MB 30 kB/s eta 0:51:49     |███████████████▉                | 86.8 MB 36 kB/s eta 0:40:44     |████████████████▍               | 90.1 MB 34 kB/s eta 0:40:50     |█████████████████               | 92.9 MB 35 kB/s eta 0:38:29     |██████████████████              | 99.0 MB 60 kB/s eta 0:20:57     |██████████████████▋             | 102.1 MB 76 kB/s eta 0:16:01     |██████████████████▉             | 103.4 MB 35 kB/s eta 0:33:33     |████████████████████▏           | 110.3 MB 23 kB/s eta 0:46:13     |████████████████████▏           | 110.5 MB 23 kB/s eta 0:45:17     |████████████████████▍           | 111.7 MB 53 kB/s eta 0:19:58     |██████████████████████▍         | 122.5 MB 91 kB/s eta 0:09:39     |███████████████████████         | 125.9 MB 119 kB/s eta 0:06:54     |██████████████████████████▋     | 145.9 MB 91 kB/s eta 0:05:22     |███████████████████████████▍    | 149.7 MB 22 kB/s eta 0:19:01     |████████████████████████████████| 175.3 MB 54 kB/s eta 0:00:01
Requirement already satisfied: scipy&gt;=1.1.0 in /opt/anaconda3/lib/python3.7/site-packages (from turicreate) (1.4.1)
Collecting protobuf&gt;=3.1.0
  Downloading protobuf-3.12.2-cp37-cp37m-macosx_10_9_x86_64.whl (1.3 MB)
     |████████████████████████████████| 1.3 MB 38 kB/s eta 0:00:01
Requirement already satisfied: chardet&lt;3.1.0,&gt;=3.0.2 in /opt/anaconda3/lib/python3.7/site-packages (from requests&gt;=2.9.1-&gt;turicreate) (3.0.4)
Requirement already satisfied: urllib3!=1.25.0,!=1.25.1,&lt;1.26,&gt;=1.21.1 in /opt/anaconda3/lib/python3.7/site-packages (from requests&gt;=2.9.1-&gt;turicreate) (1.25.8)
Requirement already satisfied: idna&lt;2.9,&gt;=2.5 in /opt/anaconda3/lib/python3.7/site-packages (from requests&gt;=2.9.1-&gt;turicreate) (2.8)
Requirement already satisfied: certifi&gt;=2017.4.17 in /opt/anaconda3/lib/python3.7/site-packages (from requests&gt;=2.9.1-&gt;turicreate) (2019.11.28)
Requirement already satisfied: pytz&gt;=2017.2 in /opt/anaconda3/lib/python3.7/site-packages (from pandas&gt;=0.23.2-&gt;turicreate) (2019.3)
Requirement already satisfied: python-dateutil&gt;=2.6.1 in /opt/anaconda3/lib/python3.7/site-packages (from pandas&gt;=0.23.2-&gt;turicreate) (2.8.1)
Requirement already satisfied: numba&gt;=0.32 in /opt/anaconda3/lib/python3.7/site-packages (from resampy==0.2.1-&gt;turicreate) (0.48.0)
Collecting termcolor&gt;=1.1.0
  Downloading termcolor-1.1.0.tar.gz (3.9 kB)
Collecting tensorflow-estimator&lt;2.3.0,&gt;=2.2.0
  Downloading tensorflow_estimator-2.2.0-py2.py3-none-any.whl (454 kB)
     |████████████████████████████████| 454 kB 49 kB/s eta 0:00:01
Requirement already satisfied: wheel&gt;=0.26; python_version &gt;= &#34;3&#34; in /opt/anaconda3/lib/python3.7/site-packages (from tensorflow&gt;=2.0.0-&gt;turicreate) (0.34.2)
Requirement already satisfied: wrapt&gt;=1.11.1 in /opt/anaconda3/lib/python3.7/site-packages (from tensorflow&gt;=2.0.0-&gt;turicreate) (1.11.2)
Collecting keras-preprocessing&gt;=1.1.0
  Downloading Keras_Preprocessing-1.1.2-py2.py3-none-any.whl (42 kB)
     |████████████████████████████████| 42 kB 67 kB/s eta 0:00:01
Collecting google-pasta&gt;=0.1.8
  Downloading google_pasta-0.2.0-py3-none-any.whl (57 kB)
     |████████████████████████████████| 57 kB 53 kB/s eta 0:00:01
Collecting astunparse==1.6.3
  Downloading astunparse-1.6.3-py2.py3-none-any.whl (12 kB)
Collecting grpcio&gt;=1.8.6
  Downloading grpcio-1.29.0-cp37-cp37m-macosx_10_9_x86_64.whl (2.8 MB)
     |████████████████████████████████| 2.8 MB 95 kB/s eta 0:00:011
Collecting gast==0.3.3
  Downloading gast-0.3.3-py2.py3-none-any.whl (9.7 kB)
Collecting opt-einsum&gt;=2.3.2
  Downloading opt_einsum-3.2.1-py3-none-any.whl (63 kB)
     |████████████████████████████████| 63 kB 71 kB/s eta 0:00:011
Collecting tensorboard&lt;2.3.0,&gt;=2.2.0
  Downloading tensorboard-2.2.2-py3-none-any.whl (3.0 MB)
     |████████████████████████████████| 3.0 MB 31 kB/s eta 0:00:01
Requirement already satisfied: h5py&lt;2.11.0,&gt;=2.10.0 in /opt/anaconda3/lib/python3.7/site-packages (from tensorflow&gt;=2.0.0-&gt;turicreate) (2.10.0)
Collecting absl-py&gt;=0.7.0
  Downloading absl-py-0.9.0.tar.gz (104 kB)
     |████████████████████████████████| 104 kB 23 kB/s eta 0:00:01
Requirement already satisfied: setuptools in /opt/anaconda3/lib/python3.7/site-packages (from protobuf&gt;=3.1.0-&gt;coremltools==3.3-&gt;turicreate) (46.0.0.post20200309)
Requirement already satisfied: llvmlite&lt;0.32.0,&gt;=0.31.0dev0 in /opt/anaconda3/lib/python3.7/site-packages (from numba&gt;=0.32-&gt;resampy==0.2.1-&gt;turicreate) (0.31.0)
Collecting tensorboard-plugin-wit&gt;=1.6.0
  Downloading tensorboard_plugin_wit-1.6.0.post3-py3-none-any.whl (777 kB)
     |████████████████████████████████| 777 kB 40 kB/s eta 0:00:01
Collecting google-auth-oauthlib&lt;0.5,&gt;=0.4.1
  Downloading google_auth_oauthlib-0.4.1-py2.py3-none-any.whl (18 kB)
Collecting google-auth&lt;2,&gt;=1.6.3
  Downloading google_auth-1.17.2-py2.py3-none-any.whl (90 kB)
     |████████████████████████████████| 90 kB 65 kB/s eta 0:00:01
Requirement already satisfied: werkzeug&gt;=0.11.15 in /opt/anaconda3/lib/python3.7/site-packages (from tensorboard&lt;2.3.0,&gt;=2.2.0-&gt;tensorflow&gt;=2.0.0-&gt;turicreate) (1.0.0)
Collecting markdown&gt;=2.6.8
  Downloading Markdown-3.2.2-py3-none-any.whl (88 kB)
     |████████████████████████████████| 88 kB 49 kB/s eta 0:00:01
Collecting requests-oauthlib&gt;=0.7.0
  Downloading requests_oauthlib-1.3.0-py2.py3-none-any.whl (23 kB)
Collecting pyasn1-modules&gt;=0.2.1
  Downloading pyasn1_modules-0.2.8-py2.py3-none-any.whl (155 kB)
     |████████████████████████████████| 155 kB 38 kB/s eta 0:00:01
Collecting rsa&lt;5,&gt;=3.1.4; python_version &gt;= &#34;3&#34;
  Downloading rsa-4.6-py2.py3-none-any.whl (34 kB)
Requirement already satisfied: cachetools&lt;5.0,&gt;=2.0.0 in /opt/anaconda3/lib/python3.7/site-packages (from google-auth&lt;2,&gt;=1.6.3-&gt;tensorboard&lt;2.3.0,&gt;=2.2.0-&gt;tensorflow&gt;=2.0.0-&gt;turicreate) (3.1.1)
Requirement already satisfied: importlib-metadata; python_version &lt; &#34;3.8&#34; in /opt/anaconda3/lib/python3.7/site-packages (from markdown&gt;=2.6.8-&gt;tensorboard&lt;2.3.0,&gt;=2.2.0-&gt;tensorflow&gt;=2.0.0-&gt;turicreate) (1.5.0)
Collecting oauthlib&gt;=3.0.0
  Downloading oauthlib-3.1.0-py2.py3-none-any.whl (147 kB)
     |████████████████████████████████| 147 kB 37 kB/s eta 0:00:01    |███████████████▋                | 71 kB 37 kB/s eta 0:00:03
Collecting pyasn1&lt;0.5.0,&gt;=0.4.6
  Downloading pyasn1-0.4.8-py2.py3-none-any.whl (77 kB)
     |████████████████████████████████| 77 kB 59 kB/s eta 0:00:01
Requirement already satisfied: zipp&gt;=0.5 in /opt/anaconda3/lib/python3.7/site-packages (from importlib-metadata; python_version &lt; &#34;3.8&#34;-&gt;markdown&gt;=2.6.8-&gt;tensorboard&lt;2.3.0,&gt;=2.2.0-&gt;tensorflow&gt;=2.0.0-&gt;turicreate) (2.2.0)
Building wheels for collected packages: resampy, termcolor, absl-py
  Building wheel for resampy (setup.py) ... done
  Created wheel for resampy: filename=resampy-0.2.1-py3-none-any.whl size=320848 sha256=13ea513477f71d513b03a44efe8db091cffc1adaab907123f0fa8d5babfdbeaf
  Stored in directory: /Users/datalab/Library/Caches/pip/wheels/71/74/53/d5ceb7c5ee7a168c7d106041863e71ac3273f4a4677743a284
  Building wheel for termcolor (setup.py) ... done
  Created wheel for termcolor: filename=termcolor-1.1.0-py3-none-any.whl size=4830 sha256=f6234bda25caf8e0d32efe0478ea409a20565a1652f05830529936dabbebc345
  Stored in directory: /Users/datalab/Library/Caches/pip/wheels/3f/e3/ec/8a8336ff196023622fbcb36de0c5a5c218cbb24111d1d4c7f2
  Building wheel for absl-py (setup.py) ... done
  Created wheel for absl-py: filename=absl_py-0.9.0-py3-none-any.whl size=121931 sha256=a0b4551addb6f776d7d3404e842ec5243b8894947bba6be78bc66c56963d37b5
  Stored in directory: /Users/datalab/Library/Caches/pip/wheels/cc/af/1a/498a24d0730ef484019e007bb9e8cef3ac00311a672c049a3e
Successfully built resampy termcolor absl-py
Installing collected packages: protobuf, coremltools, resampy, termcolor, tensorflow-estimator, keras-preprocessing, google-pasta, astunparse, grpcio, gast, opt-einsum, tensorboard-plugin-wit, pyasn1, pyasn1-modules, rsa, google-auth, oauthlib, requests-oauthlib, google-auth-oauthlib, absl-py, markdown, tensorboard, tensorflow, turicreate
Successfully installed absl-py-0.9.0 astunparse-1.6.3 coremltools-3.3 gast-0.3.3 google-auth-1.17.2 google-auth-oauthlib-0.4.1 google-pasta-0.2.0 grpcio-1.29.0 keras-preprocessing-1.1.2 markdown-3.2.2 oauthlib-3.1.0 opt-einsum-3.2.1 protobuf-3.12.2 pyasn1-0.4.8 pyasn1-modules-0.2.8 requests-oauthlib-1.3.0 resampy-0.2.1 rsa-4.6 tensorboard-2.2.2 tensorboard-plugin-wit-1.6.0.post3 tensorflow-2.2.0 tensorflow-estimator-2.2.0 termcolor-1.1.0 turicreate-6.3
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">turicreate</span> <span class="k">as</span> <span class="nn">tc</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="&#19979;&#36733;&#25968;&#25454;">&#19979;&#36733;&#25968;&#25454;<a class="anchor-link" href="#&#19979;&#36733;&#25968;&#25454;"> </a></h1><p><a href="http://s3.amazonaws.com/dato-datasets/millionsong/10000.txt">http://s3.amazonaws.com/dato-datasets/millionsong/10000.txt</a></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#train_file = &#39;http://s3.amazonaws.com/dato-datasets/millionsong/10000.txt&#39;</span>
<span class="n">train_file</span> <span class="o">=</span> <span class="s1">&#39;/Users/datalab/bigdata/cjc/millionsong/song_usage_10000.txt&#39;</span>
<span class="n">sf</span> <span class="o">=</span> <span class="n">tc</span><span class="o">.</span><span class="n">SFrame</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">train_file</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">sf</span> <span class="o">=</span> <span class="n">sf</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;X1&#39;</span><span class="p">:</span><span class="s1">&#39;user_id&#39;</span><span class="p">,</span> <span class="s1">&#39;X2&#39;</span><span class="p">:</span><span class="s1">&#39;music_id&#39;</span><span class="p">,</span> <span class="s1">&#39;X3&#39;</span><span class="p">:</span><span class="s1">&#39;rating&#39;</span><span class="p">})</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_set</span><span class="p">,</span> <span class="n">test_set</span> <span class="o">=</span> <span class="n">sf</span><span class="o">.</span><span class="n">random_split</span><span class="p">(</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">popularity_model</span> <span class="o">=</span> <span class="n">tc</span><span class="o">.</span><span class="n">popularity_recommender</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">train_set</span><span class="p">,</span> 
                                                    <span class="s1">&#39;user_id&#39;</span><span class="p">,</span> <span class="s1">&#39;music_id&#39;</span><span class="p">,</span> 
                                                    <span class="n">target</span> <span class="o">=</span> <span class="s1">&#39;rating&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>Preparing data set.</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>    Data has 1599753 observations with 76085 users and 10000 items.</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>    Data prepared in: 4.15079s</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>1599753 observations to process; with 10000 unique items.</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">item_sim_model</span> <span class="o">=</span> <span class="n">tc</span><span class="o">.</span><span class="n">item_similarity_recommender</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">train_set</span><span class="p">,</span> 
                                                       <span class="s1">&#39;user_id&#39;</span><span class="p">,</span> <span class="s1">&#39;music_id&#39;</span><span class="p">,</span> 
                                                       <span class="n">target</span> <span class="o">=</span> <span class="s1">&#39;rating&#39;</span><span class="p">,</span> 
                                                       <span class="n">similarity_type</span><span class="o">=</span><span class="s1">&#39;cosine&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>Preparing data set.</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>    Data has 1599753 observations with 76085 users and 10000 items.</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>    Data prepared in: 3.7942s</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>Training model from provided data.</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>Gathering per-item and per-user statistics.</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>+--------------------------------+------------+</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>| Elapsed Time (Item Statistics) | % Complete |</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>+--------------------------------+------------+</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>| 7.569ms                        | 2.5        |</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>| 90.88ms                        | 100        |</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>+--------------------------------+------------+</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>Setting up lookup tables.</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>Processing data in one pass using dense lookup tables.</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>+-------------------------------------+------------------+-----------------+</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>| Elapsed Time (Constructing Lookups) | Total % Complete | Items Processed |</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>+-------------------------------------+------------------+-----------------+</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>| 605.016ms                           | 0                | 0               |</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>| 4.01s                               | 100              | 10000           |</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>+-------------------------------------+------------------+-----------------+</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>Finalizing lookup tables.</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>Generating candidate set for working with new users.</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>Finished training in 5.31028s</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">factorization_machine_model</span> <span class="o">=</span> <span class="n">tc</span><span class="o">.</span><span class="n">recommender</span><span class="o">.</span><span class="n">factorization_recommender</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">train_set</span><span class="p">,</span> 
                                                                              <span class="s1">&#39;user_id&#39;</span><span class="p">,</span> <span class="s1">&#39;music_id&#39;</span><span class="p">,</span>
                                                                              <span class="n">target</span><span class="o">=</span><span class="s1">&#39;rating&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>Preparing data set.</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>    Data has 1599753 observations with 76085 users and 10000 items.</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>    Data prepared in: 4.32575s</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>Training factorization_recommender for recommendations.</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>+--------------------------------+--------------------------------------------------+----------+</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>| Parameter                      | Description                                      | Value    |</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>+--------------------------------+--------------------------------------------------+----------+</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>| num_factors                    | Factor Dimension                                 | 8        |</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>| regularization                 | L2 Regularization on Factors                     | 1e-08    |</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>| solver                         | Solver used for training                         | sgd      |</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>| linear_regularization          | L2 Regularization on Linear Coefficients         | 1e-10    |</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>| max_iterations                 | Maximum Number of Iterations                     | 50       |</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>+--------------------------------+--------------------------------------------------+----------+</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>  Optimizing model using SGD; tuning step size.</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>  Using 199969 / 1599753 points for tuning the step size.</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>+---------+-------------------+------------------------------------------+</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>| Attempt | Initial Step Size | Estimated Objective Value                |</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>+---------+-------------------+------------------------------------------+</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>| 0       | 25                | No Decrease (230.933 >= 43.5401)         |</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>| 1       | 6.25              | No Decrease (219.447 >= 43.5401)         |</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>| 2       | 1.5625            | No Decrease (191.895 >= 43.5401)         |</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>| 3       | 0.390625          | No Decrease (89.356 >= 43.5401)          |</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>| 4       | 0.0976562         | 16.0024                                  |</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>| 5       | 0.0488281         | 11.4371                                  |</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>| 6       | 0.0244141         | 24.5498                                  |</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>+---------+-------------------+------------------------------------------+</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>| Final   | 0.0488281         | 11.4371                                  |</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>+---------+-------------------+------------------------------------------+</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>Starting Optimization.</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>+---------+--------------+-------------------+-----------------------+-------------+</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>| Iter.   | Elapsed Time | Approx. Objective | Approx. Training RMSE | Step Size   |</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>+---------+--------------+-------------------+-----------------------+-------------+</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>| Initial | 387us        | 43.795            | 6.61778               |             |</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>+---------+--------------+-------------------+-----------------------+-------------+</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>| 1       | 681.41ms     | 43.5465           | 6.59858               | 0.0488281   |</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>| 2       | 1.25s        | 40.8911           | 6.39426               | 0.0290334   |</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>| 3       | 1.97s        | 37.9926           | 6.16345               | 0.0214205   |</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>| 4       | 2.74s        | 35.4229           | 5.95132               | 0.0172633   |</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>| 5       | 3.26s        | 32.7792           | 5.72487               | 0.014603    |</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>| 10      | 5.91s        | 24.5046           | 4.94956               | 0.008683    |</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>| 15      | 9.07s        | 20.0943           | 4.48185               | 0.00640622  |</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>| 20      | 11.83s       | 17.639            | 4.19895               | 0.00516295  |</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>| 25      | 14.27s       | 15.7055           | 3.96197               | 0.00436732  |</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>| 30      | 16.57s       | 14.3953           | 3.79299               | 0.00380916  |</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>| 35      | 18.71s       | 13.3639           | 3.65445               | 0.00339327  |</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>| 40      | 20.92s       | 12.5027           | 3.53463               | 0.00306991  |</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>| 45      | 23.89s       | 11.8108           | 3.43534               | 0.00281035  |</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>| 50      | 26.34s       | 9.85419           | 3.13763               | 0.00154408  |</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>+---------+--------------+-------------------+-----------------------+-------------+</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>Optimization Complete: Maximum number of passes through the data reached.</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>Computing final objective value and training RMSE.</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>       Final objective value: 8.8282</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>       Final training RMSE: 2.96963</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">train_set</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>1599753</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">tc</span><span class="o">.</span><span class="n">recommender</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">compare_models</span><span class="p">(</span><span class="n">test_set</span><span class="p">,</span> 
                                            <span class="p">[</span><span class="n">popularity_model</span><span class="p">,</span> <span class="n">item_sim_model</span><span class="p">,</span> <span class="n">factorization_machine_model</span><span class="p">],</span>
                                            <span class="n">user_sample</span><span class="o">=.</span><span class="mi">5</span><span class="p">,</span> <span class="n">skip_set</span><span class="o">=</span><span class="n">train_set</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>compare_models: using 34354 users to estimate model performance
PROGRESS: Evaluate model M0
</pre>
</div>
</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 1000/34354 queries. users per second: 5393.6</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 2000/34354 queries. users per second: 5901.05</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 3000/34354 queries. users per second: 5891.65</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 4000/34354 queries. users per second: 5752.93</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 5000/34354 queries. users per second: 5841.69</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 6000/34354 queries. users per second: 5762.33</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 7000/34354 queries. users per second: 5834.76</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 8000/34354 queries. users per second: 5904.72</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 9000/34354 queries. users per second: 5766.33</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 10000/34354 queries. users per second: 5748.05</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 11000/34354 queries. users per second: 5619.56</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 12000/34354 queries. users per second: 5600.83</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 13000/34354 queries. users per second: 5659.63</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 14000/34354 queries. users per second: 5537.91</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 15000/34354 queries. users per second: 5566.55</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 16000/34354 queries. users per second: 5566.55</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 17000/34354 queries. users per second: 5541.39</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 18000/34354 queries. users per second: 5537.43</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 19000/34354 queries. users per second: 5494.31</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 20000/34354 queries. users per second: 5540.8</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 21000/34354 queries. users per second: 5567.68</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 22000/34354 queries. users per second: 5596</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 23000/34354 queries. users per second: 5594.48</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 24000/34354 queries. users per second: 5551.09</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 25000/34354 queries. users per second: 5561.67</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 26000/34354 queries. users per second: 5526.95</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 27000/34354 queries. users per second: 5465.2</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 28000/34354 queries. users per second: 5437.18</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 29000/34354 queries. users per second: 5444.31</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 30000/34354 queries. users per second: 5452.98</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 31000/34354 queries. users per second: 5430.37</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 32000/34354 queries. users per second: 5407.57</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 33000/34354 queries. users per second: 5386.39</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 34000/34354 queries. users per second: 5405.75</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
Precision and recall summary statistics by cutoff
+--------+------------------------+------------------------+
| cutoff |     mean_precision     |      mean_recall       |
+--------+------------------------+------------------------+
|   1    | 0.00040752168597543237 | 7.081875226074056e-05  |
|   2    | 0.0004075216859754322  | 0.00011226035987334286 |
|   3    | 0.0003104927131241391  | 0.00012739048212345128 |
|   4    | 0.00034202712930080884 | 0.0002353030396709293  |
|   5    | 0.00046573906968620603 | 0.00046444872494981606 |
|   6    | 0.0004414818264733844  | 0.0005228618282305431  |
|   7    |  0.00043247199328005   | 0.0005736297245772213  |
|   8    | 0.0004075216859754325  | 0.0006087229198555468  |
|   9    | 0.0004528018733060353  | 0.0007391431080220185  |
|   10   | 0.00043080863945974164 | 0.0007735092654785608  |
+--------+------------------------+------------------------+
[10 rows x 3 columns]


Overall RMSE: 5.9110406201585715

Per User RMSE (best)
+-------------------------------+------+-------+
|            user_id            | rmse | count |
+-------------------------------+------+-------+
| cafbf96566378466408b7b3c76... | 0.0  |   1   |
+-------------------------------+------+-------+
[1 rows x 3 columns]


Per User RMSE (worst)
+-------------------------------+-------------------+-------+
|            user_id            |        rmse       | count |
+-------------------------------+-------------------+-------+
| 38767872c514c1b43bab5c7b21... | 341.2071760874715 |   2   |
+-------------------------------+-------------------+-------+
[1 rows x 3 columns]


Per Item RMSE (best)
+--------------------+---------------------+-------+
|      music_id      |         rmse        | count |
+--------------------+---------------------+-------+
| SOXDPFW12A81C2319B | 0.07352941176470584 |   5   |
+--------------------+---------------------+-------+
[1 rows x 3 columns]


Per Item RMSE (worst)
+--------------------+--------------------+-------+
|      music_id      |        rmse        | count |
+--------------------+--------------------+-------+
| SOPKTFQ12A67021600 | 124.75180499529567 |   9   |
+--------------------+--------------------+-------+
[1 rows x 3 columns]

PROGRESS: Evaluate model M1
</pre>
</div>
</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 1000/34354 queries. users per second: 5825.84</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 2000/34354 queries. users per second: 5301.82</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 3000/34354 queries. users per second: 5419.21</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 4000/34354 queries. users per second: 5627.83</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 5000/34354 queries. users per second: 5771.93</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 6000/34354 queries. users per second: 5585.3</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 7000/34354 queries. users per second: 5365.4</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 8000/34354 queries. users per second: 5147.5</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 9000/34354 queries. users per second: 5252.85</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 10000/34354 queries. users per second: 5301.11</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 11000/34354 queries. users per second: 5257.75</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 12000/34354 queries. users per second: 5181.17</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 13000/34354 queries. users per second: 5139.25</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 14000/34354 queries. users per second: 5155.66</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 15000/34354 queries. users per second: 4967.57</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 16000/34354 queries. users per second: 4921.83</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 17000/34354 queries. users per second: 4990.4</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 18000/34354 queries. users per second: 5068.35</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 19000/34354 queries. users per second: 5140.77</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 20000/34354 queries. users per second: 5213.8</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 21000/34354 queries. users per second: 5184.08</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 22000/34354 queries. users per second: 5094.51</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 23000/34354 queries. users per second: 5146.65</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 24000/34354 queries. users per second: 5170.89</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 25000/34354 queries. users per second: 5200.77</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 26000/34354 queries. users per second: 5183.28</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 27000/34354 queries. users per second: 5222.37</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 28000/34354 queries. users per second: 5251.88</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 29000/34354 queries. users per second: 5272.72</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 30000/34354 queries. users per second: 5288.9</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 31000/34354 queries. users per second: 5280.69</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 32000/34354 queries. users per second: 5272.44</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 33000/34354 queries. users per second: 5320.29</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 34000/34354 queries. users per second: 5353.61</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
Precision and recall summary statistics by cutoff
+--------+----------------------+----------------------+
| cutoff |    mean_precision    |     mean_recall      |
+--------+----------------------+----------------------+
|   1    | 0.12356639692612195  | 0.027394188372094497 |
|   2    | 0.10617395354252777  |  0.0450683741242837  |
|   3    | 0.09521453105897464  | 0.059418188595173727 |
|   4    | 0.08673662455609242  | 0.07079052813704197  |
|   5    | 0.08053792862548775  | 0.08078157252034639  |
|   6    | 0.07570685606722138  | 0.09033226689608059  |
|   7    | 0.07142441304402039  | 0.09836168110578075  |
|   8    | 0.06780869767712655  | 0.10631301678527204  |
|   9    | 0.06465687320900597  |  0.1134367927631828  |
|   10   | 0.061861791931070574 | 0.11986145197856829  |
+--------+----------------------+----------------------+
[10 rows x 3 columns]


Overall RMSE: 6.6935880472475

Per User RMSE (best)
+-------------------------------+--------------------+-------+
|            user_id            |        rmse        | count |
+-------------------------------+--------------------+-------+
| f015c8ec1487d172a76e8af6fd... | 0.0991658329963685 |   1   |
+-------------------------------+--------------------+-------+
[1 rows x 3 columns]


Per User RMSE (worst)
+-------------------------------+-------------------+-------+
|            user_id            |        rmse       | count |
+-------------------------------+-------------------+-------+
| 38767872c514c1b43bab5c7b21... | 346.8117700274172 |   2   |
+-------------------------------+-------------------+-------+
[1 rows x 3 columns]


Per Item RMSE (best)
+--------------------+--------------------+-------+
|      music_id      |        rmse        | count |
+--------------------+--------------------+-------+
| SOAVQRP12A8C13120B | 0.8293558937901314 |   4   |
+--------------------+--------------------+-------+
[1 rows x 3 columns]


Per Item RMSE (worst)
+--------------------+-------------------+-------+
|      music_id      |        rmse       | count |
+--------------------+-------------------+-------+
| SOPKTFQ12A67021600 | 128.8226138396836 |   9   |
+--------------------+-------------------+-------+
[1 rows x 3 columns]

PROGRESS: Evaluate model M2
</pre>
</div>
</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 1000/34354 queries. users per second: 5658.25</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 2000/34354 queries. users per second: 6360.82</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 3000/34354 queries. users per second: 6111.59</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 4000/34354 queries. users per second: 5757.38</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 5000/34354 queries. users per second: 5756.7</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 6000/34354 queries. users per second: 5927.31</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 7000/34354 queries. users per second: 6043.27</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 8000/34354 queries. users per second: 6053.29</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 9000/34354 queries. users per second: 6008.53</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 10000/34354 queries. users per second: 6029.76</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 11000/34354 queries. users per second: 5973.13</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 12000/34354 queries. users per second: 5982.24</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 13000/34354 queries. users per second: 5945.1</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 14000/34354 queries. users per second: 5940.6</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 15000/34354 queries. users per second: 5976.12</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 16000/34354 queries. users per second: 5915.28</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 17000/34354 queries. users per second: 5818.41</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 18000/34354 queries. users per second: 5838.5</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 19000/34354 queries. users per second: 5876.56</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 20000/34354 queries. users per second: 5943.82</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 21000/34354 queries. users per second: 5952.95</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 22000/34354 queries. users per second: 5934.66</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 23000/34354 queries. users per second: 5937.77</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 24000/34354 queries. users per second: 5984.55</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 25000/34354 queries. users per second: 5983.3</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 26000/34354 queries. users per second: 5979.39</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 27000/34354 queries. users per second: 5971.13</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 28000/34354 queries. users per second: 6012.81</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 29000/34354 queries. users per second: 6001.44</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 30000/34354 queries. users per second: 6024.65</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 31000/34354 queries. users per second: 5997.94</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 32000/34354 queries. users per second: 5964.91</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 33000/34354 queries. users per second: 5996.43</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<pre>recommendations finished on 34000/34354 queries. users per second: 6000.34</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
Precision and recall summary statistics by cutoff
+--------+-----------------------+------------------------+
| cutoff |     mean_precision    |      mean_recall       |
+--------+-----------------------+------------------------+
|   1    |  0.000611282528963149 | 0.00015967112604116908 |
|   2    | 0.0005094021074692894 | 0.00020969792246105614 |
|   3    | 0.0005142535561118539 | 0.0002897975387832757  |
|   4    | 0.0005312336263608328 | 0.0004549968288297451  |
|   5    | 0.0005414216685102181 | 0.0005703895459784241  |
|   6    |  0.000548213696609806 | 0.0007142050704628652  |
|   7    | 0.0005738570680062202 | 0.0008314573503625282  |
|   8    | 0.0005930895965535321 | 0.0009602957110903129  |
|   9    | 0.0006015796316780176 | 0.0011215295194248998  |
|   10   | 0.0005967281830354553 | 0.0012125256843862468  |
+--------+-----------------------+------------------------+
[10 rows x 3 columns]


Overall RMSE: 7.641661679566184

Per User RMSE (best)
+-------------------------------+-----------------------+-------+
|            user_id            |          rmse         | count |
+-------------------------------+-----------------------+-------+
| 220f26b368277020c4e685351a... | 5.398923054400484e-06 |   1   |
+-------------------------------+-----------------------+-------+
[1 rows x 3 columns]


Per User RMSE (worst)
+-------------------------------+-------------------+-------+
|            user_id            |        rmse       | count |
+-------------------------------+-------------------+-------+
| 38767872c514c1b43bab5c7b21... | 360.3407134339816 |   2   |
+-------------------------------+-------------------+-------+
[1 rows x 3 columns]


Per Item RMSE (best)
+--------------------+----------------------+-------+
|      music_id      |         rmse         | count |
+--------------------+----------------------+-------+
| SOAESGK12A8C138488 | 0.028188730543956098 |   1   |
+--------------------+----------------------+-------+
[1 rows x 3 columns]


Per Item RMSE (worst)
+--------------------+--------------------+-------+
|      music_id      |        rmse        | count |
+--------------------+--------------------+-------+
| SOPKTFQ12A67021600 | 126.00562214029682 |   9   |
+--------------------+--------------------+-------+
[1 rows x 3 columns]

</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">K</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">users</span> <span class="o">=</span> <span class="n">gl</span><span class="o">.</span><span class="n">SArray</span><span class="p">(</span><span class="n">sf</span><span class="p">[</span><span class="s1">&#39;user_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">recs</span> <span class="o">=</span> <span class="n">item_sim_model</span><span class="o">.</span><span class="n">recommend</span><span class="p">(</span><span class="n">users</span><span class="o">=</span><span class="n">users</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">K</span><span class="p">)</span>
<span class="n">recs</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div style="max-height:1000px;max-width:1500px;overflow:auto;"><table frame="box" rules="cols">
    <tr>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">user_id</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">music_id</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">score</th>
        <th style="padding-left: 1em; padding-right: 1em; text-align: center">rank</th>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">279292bb36dbfc7f505e36ebf<br>038c81eb1d1d63e ...</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">SOXUQNR12AF72A69D6</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">3.022422651449839</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">1</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">279292bb36dbfc7f505e36ebf<br>038c81eb1d1d63e ...</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">SOUFAZA12AC3DFAB20</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">1.3368427753448486</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">2</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">279292bb36dbfc7f505e36ebf<br>038c81eb1d1d63e ...</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">SOSFSTC12A8C141219</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">1.091982126235962</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">3</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">279292bb36dbfc7f505e36ebf<br>038c81eb1d1d63e ...</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">SOVIWFP12A58A7D1BD</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">1.045163869857788</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">4</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">279292bb36dbfc7f505e36ebf<br>038c81eb1d1d63e ...</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">SOBMTQD12AB01833D0</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">1.0294516881306965</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">5</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">279292bb36dbfc7f505e36ebf<br>038c81eb1d1d63e ...</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">SOCMNRG12AB0189D3F</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">0.9756437937418619</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">6</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">279292bb36dbfc7f505e36ebf<br>038c81eb1d1d63e ...</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">SOXOHUM12A67ADC826</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">0.9506873289744059</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">7</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">279292bb36dbfc7f505e36ebf<br>038c81eb1d1d63e ...</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">SOWBFVW12A6D4F612B</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">0.9092370669047037</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">8</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">279292bb36dbfc7f505e36ebf<br>038c81eb1d1d63e ...</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">SOXFYTY127E9433E7D</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">0.8977278073628744</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">9</td>
    </tr>
    <tr>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">279292bb36dbfc7f505e36ebf<br>038c81eb1d1d63e ...</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">SOYBLYP12A58A79D32</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">0.8970928192138672</td>
        <td style="padding-left: 1em; padding-right: 1em; text-align: center; vertical-align: top">10</td>
    </tr>
</table>
[10 rows x 4 columns]<br/>
</div>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

 


    </main>
    
            </div>
            <nav class="c-page__nav">
  
    
    <a id="js-page__nav__prev" class="c-page__nav__prev" href="/ccbook/13-recsys-intro.html">
      〈 <span class="u-margin-right-tiny"></span> 
    </a>
  

  
    
    <a id="js-page__nav__next" class="c-page__nav__next" href="/ccbook/14-movielens.html">
       <span class="u-margin-right-tiny"></span> 〉
    </a>
  
</nav>
            <footer>
  <p class="footer">This page was created by <a href="https://github.com/jupyter/jupyter-book/graphs/contributors">The Jupyter Book Community</a></p>
</footer>

        </div>
      </main>
    </div>
  </body>
</html>
